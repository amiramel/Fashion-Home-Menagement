
 <div class="content">
    <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="page-header"> לקוחה :{{bride.first_name}} {{bride.last_name}} <small> (מצב : {{bride.status}})  מתחתנת ב: {{bride.date_event | date:"dd/MM/yy"}}</small></h2>
                    <div class="col-md-4">
                        <div class="panel panel-info" >
                            <div class="panel-heading"> פרטים אישיים <small>( נוצר ב {{bride.created_at | date:"HH:MM , dd/MM/yy"}} )</small>
                                <i class="fa fa-save" style="float: left" ng-click="update(bride)"  ng-show="modifyField" > שמירה</i>
                                <i class="fa fa-pencil" style="float: left" ng-click="modify(bride)"ng-hide="viewField"> עריכה</i>
                            </div>
                            <div class="panel-body" >
                            <table class="table table-bordered table-hover table-condensed" style="width:100%" id="tStyle">
                                <form mame="brideFrom">
                                        <tr style="text-align: center">
                                            <th  id="thStyle">שם פרטי:   </th> 
                                            <td ng-show="modifyField"><input type="text" ng-model="bride.first_name"  name="first_name" required />
                                                <div ng-messages="brideForm.first_name.$error  && brideForm.first_name.$dirty" >
                                               </div>
                                            </td>
                                            <td ng-hide="viewField">{{bride.first_name || ''}}</td>
                                        </tr>
                                        <tr style="text-align: center"> 
                                            <th  id="thStyle">שם משפחה:   </th> 
                                            <td ng-hide="viewField">{{bride.last_name || ''}}</td>
                                            <td ng-show="modifyField"><input type="text" ng-model="bride.last_name" name="last_name" required/>
                                            <div ng-messages="brideForm.last_name.$error  && brideForm.last_name.$dirty" >
                                                <div ng-message="required">הכנס משפחה </div>
                                               </div>
                                            </td>
                                        </tr>
                                        <tr style="text-align: center">
                                            <th  id="thStyle">תעודת זהות:  </th> 
                                            <td ng-show="modifyField"> <input type="number" ng-model="bride.b_id"  name="b_id" required>
                                              <div ng-messages="brideForm.b_id.$error  && brideForm.b_id.$dirty" >
                                                <div ng-message="required">הכנס ת"ז </div>
                                               </div>
                                               </td>
                                            <td ng-hide="viewField">  {{bride.b_id ||''}}</td>
                                        </tr>
                                        <tr style="text-align: center">
                                            <th  id="thStyle">דואר אלקטרוני:</th> 
                                            <td  ng-show="modifyField"> <input type="email" ng-model="bride.email"></td>
                                                <td ng-hide="viewField"> {{bride.email ||''}}</td>
                                        </tr>
                                        <tr style="text-align: center">
                                            <th  id="thStyle">פלאפון </th>
                                            <td  ng-show="modifyField"> <input type="tel" ng-model="bride.phone1" name="phone1"  ng-pattern="/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/" required>
                                                <div ng-messages="brideForm.phone1.$error  && brideForm.phone1.$dirty" >
                                                <div ng-message="required">הכנס פלאפון </div>
                                               </div>
                                            </td>
                                            <td ng-hide="viewField">  {{bride.phone1 ||''}}</td>
                                        </tr >
                                        <tr style="text-align: center">
                                            <th  id="thStyle"> 2 פלאפון </th>
                                            <td ng-show="modifyField"> <input type="tel" ng-model="bride.phone2"></td>
                                                <td ng-hide="viewField">{{bride.phone2 ||''}}</td>
                                        </tr>
                                        <tr style="text-align: center">
                                            <th  id="thStyle"> כתובת </th>
                                            <td ng-show="modifyField"><input type="text" ng-model="bride.adress"></td>
                                            <td ng-hide="viewField">{{bride.adress ||''}}</td>
                                        </tr>
                                        
                                        <tr style="text-align: center">
                                            <th  id="thStyle"> תאריך אירוע : </th> 
                                            <td ng-show="modifyField"> <input type="date" ng-model="bride.date_event" name="date_event"ng-chenge="checkErr"   required>
                                               <div ng-messages="brideForm.date_event.$error  && brideForm.date_event.$dirty" >
                                                <div ng-message="required">הכנס פלאפון </div>
                                                <span>{{errMessage}}</span>
                                               </div>
                                            </td>
                                        <td ng-hide="viewField"> {{bride.date_event |date:"dd/MM/yy"}}</td>
                                        </tr>
                                        <tr style="text-align: center">
                                            <th  id="thStyle"> יום שירות :</th>
                                                <td  ng-show="modifyField">
                                                    <div class="radio">
                                                    <label>
                                                    <input type="radio" value="כן" ng-model="bride.day_service" name="day_service" />
                                                    </label>כן
                                                    </div>
                                                    <div class="radio">
                                                    <label>
                                                        
                                                        <input type="radio" value="לא" ng-model="bride.day_service" name="day_service" > 
                                                    </label>לא
                                                    </div>
                                                 </td>
                                            <td ng-hide="viewField">{{bride.day_service ||''}}</td>
                                        </tr>
                                        <tr style="text-align:center">
                                            <th id="thStyle">איך הגעתי </th>
                                            <td ng-show="modifyField">     
                                                <div class="radio">   
                                                    <label>
                                                        <input type="radio" value="facebook" ng-model="bride.advertising" name="advertising" placeholder="faceboo" />  &nbsp &nbsp &nbsp &nbsp facebook
                                                    </label>
                                                    </div>
                                                    <div class="radio">
                                                    <label> 
                                                        <input type="radio" value="מתחתנים" ng-model="bride.advertising" name="advertising" > &nbsp &nbsp &nbsp &nbsp מתחתנים
                                                    </label>
                                                    </div>
                                                <div class="radio">
                                                    <label> 
                                                        <input type="radio" value="אתר הבית" ng-model="bride.advertising" name="advertising" > &nbsp &nbsp &nbsp &nbsp אתר הבית
                                                    </label>
                                                    </div>
                                                    <div class="radio">
                                                    <label> 
                                                        <input type="radio" value="חבר מביא חבר" ng-model="bride.advertising" name="advertising" > &nbsp &nbsp &nbsp &nbsp חבר מביא חבר
                                                    </label>
                                                   </div>
                                            </td>
                                            <td ng-hide="viewField">{{bride.advertising ||''}}</td>
                                        </tr>
                                        <tr style="text-align: center">
                                            <th  id="thStyle"> הערות  :</th>
                                            <td ng-show="modifyField"> <input type="text" ng-model="bride.remark"></td>
                                            <td ng-hide="viewField">{{bride.remark ||''}}</td>
                                        </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                <div class="col-md-8">
                                <div class="panel panel-info">
                                    <div class="panel-heading"> שמלות  
                                      <button style="float: left" type="button" class="btn btn-primary" ng-click="stageRoute(bride._id)" ng-show= "user_role == 1 || user_role == 2"  data-toggle="tooltip" data-placement="top" title="שלבי שמלה "><i class="fa fa-sitemap" aria-hidden="true" ></i>  </button>
                                    </div>
                                    <div class="panel-body">
                                        
                                            <table class="table table-bordered table-hover table-condensed" style="width:100%">        
                                                 <tr ng-show= "user_role == 1 || user_role == 2">
                                                    <div class="form-group"  >
                                                        <th>	
                                                        <select  ng-model="newDress.t_dress" name="t_dress" placeholder=" סוג שמלה " value="סוג שמלה" class="form-control"  required/ >
                                                            <option >כלה</option>
                                                            <option>ערב</option>
                                                        </select>
                                                        </th>
                                                    </div>
                                                    <div>
                                                     <th >
                                                        <input type="text" class="form-control" ng-model="newDress.model" name="model" placeholder="דגם שמלה" value="" required />
                                                    </th>
                                                    </div>
                                                    <div>
                                                     <th >
                                                        <input type="text" class="form-control" ng-model="newDress.price_dress" name="price_dress" placeholder="סכום שמלה" value="" required />
                                                    </th>
                                                    </div>
                           
                                                    <th>
                                                        <button type=" submit" class="btn btn-success btn-sm form-control"   ng-click="addDress(newDress)" ng-disabled="dressForm.$invalid">הוספה <i class="fa fa-plus" aria-hidden="true"></i> </button>
                                                    </th>
                                                </tr>
                                                <tr  ng-repeat="dress in brideWithDress.dresses track by $index"  style="text-align: center">
                                                        <td ng-show="dressModifyField"><input type="text" ng-model="dress.t_dress"/></td>
                                                        <td ng-hide="dressViewField">{{dress.t_dress}}</td>
                                                        
                                                        <td ng-show="dressModifyField"><input type="text" ng-model="dress.model"/></td>
                                                        <td ng-hide="dressViewField">{{dress.model}}</td>

                                                        <td  ng-show="dressModifyField" ><input type="text" ng-model="dress.price_dress"/></td>
                                                        <td  ng-hide= "user_role == 3" ng-hide="dressViewField">{{dress.price_dress}}</td>
                                                        <td ng-show= "user_role == 1 || user_role == 2">
                                                            <button  type="button" class="btn btn-primary btn-sm" ng-click="dressModify(dress ,dress._id)" ng-hide="dressViewField" ng-hide= "user_role == 3">  <i class="fa fa-pencil"></i> </button>
                                                            <button type="button" class="btn btn-success btn-sm" ng-click="upDress(dress ,dress._id ,bride)"  ng-show="dressModifyField" ng-show= "user_role == 1 || user_role ==2">  <i class="fa fa-save"></i> </button>
                                                            <button type="button" class="btn btn-info btn-sm" ng-click="dressInfoRoute(dress._id)"><i class="fa fa-folder-open" aria-hidden="true"></i></button>
                                                            <button type="button" class="btn btn-danger btn-sm" ng-click="delDress(dress._id, dress.price_dress)" ng-hide= "user_role == 3" data-placement="top" title="מחיקה" >  <i class="fa fa-trash-o"></i> </button>
                                                        </td>
                                                        <td ng-show= "user_role == 3 ">
                                                         <button type="button" class="btn btn-info btn-sm" ng-click="dressInfoRoute(dress._id)"><i class="fa fa-folder-open" aria-hidden="true"></i></button>
                                                        </td>
                                                </tr>
                                            </table>
                                            
                                    </div>
                                    <div class="panel-footer" ng-hide= "user_role == 3">
                                        סה"כ :{{getTotalPrice()}}
                                    </div>
                                </div>
                  
                    </div> 
                </div>
                      <div class="col-md-12"  ng-show= "user_role == 1 || user_role ==2">
                        <div class="panel panel-info" >
                            <div class="panel-heading">  סה"כ לתשלום: <b style="color: red"><i class="fa fa-ils" aria-hidden="true"> </i> {{bride.price}} </b><i class="fa fa-pencil" style="float: left"></i> </div>
                            <div class="panel-body" >
                                <table class="table table-bordered table-hover table-condensed" >       
                                        <tr >
                                            <th>
                                                <input type="text"  ng-model="newPayment.pay" placeholder=" סכום תשלום " value="" class="form-control">
                                            </th>
                                            <th>
                                                <input type="date"  ng-model="newPayment.date_pay" class="form-control">
                                            </th>
                                            
                                            <th>
                                                <input type="checkbox" value="כן" ng-model="newPayment.done"  > בוצע 
                                            </th>
                                            
                                            <th>
                                                <button type="button" class="btn btn-success btn-sm"  ng-click="addPayment(newPayment)" class="form-control" >הוספה <i class="fa fa-plus" aria-hidden="true"></i></button>
                                            </th>
                                        </tr>
                                        <tr class="brides" ng-repeat="payment in brideWithPayment.payments"  style="text-align: center">
                                            
                                                <td ng-show="paymentModifyField"><input type="number" ng-model="payment.pay"/></td>
                                                <td ng-hide="paymentViewField">{{payment.pay}}</td>

                                                <td ng-show="paymentModifyField"><input type="date" ng-model="payment.date_pay"/></td>
                                                <td ng-hide="paymentViewField">{{payment.date_pay | date:"dd/MM/yy"}}</td>

                                                <td ng-show="paymentModifyField"><input type="checkbox" value="כן" ng-model="payment.done"/></td>
                                                 <td ng-hide="paymentViewField">{{ dpay(payment.done)}}</td>
                                                <td>

                                                    <button type="button" class="btn btn-info btn-sm" ng-click="paymentModify(payment ,payment._id)" ng-hide="paymentViewField"> <i class="fa fa-pencil"></i> </button>
                                                    <button type="button" class="btn btn-info btn-sm" ng-click="upPayment(payment ,payment._id)"  ng-show="paymentModifyField"> <i class="fa fa-save"></i> </button>
                                                    <button type="button" class="btn btn-danger btn-sm" ng-click="delPayment(payment._id)">  <i class="fa fa-trash-o"></i> </button>
                                                </td>
                                        </tr>
                                        <tr>
                                            <td >
                                        חישוב כל התשלומים <b style="color: darkblue"><i class="fa fa-ils" aria-hidden="true"> </i> {{allPayment()}} </b>
                                            </td>
                                            <td></td>
                                        <td >
                                            סה"כ שולם <b style="color: green"><i class="fa fa-ils" aria-hidden="true"> </i> {{getTotal()}}</b>, מתוך  <b style="color: red"><i class="fa fa-ils" aria-hidden="true"> </i> {{bride.price}} </b>
                                            </td>
                                            <td> </td>
                                        </tr>
                                    
                                </table>
                            </div>
                                <div class=" panel-footer" > 
                                    יתרה לתשלום: <b style="color: red"><i class="fa fa-ils" aria-hidden="true"> </i> {{bride.price - getTotal()}} </b> 
                                </div>
                        </div>
                    </div>   
                </div>
        </div>
 </div>





